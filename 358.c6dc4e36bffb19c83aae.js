"use strict";(self.webpackChunkstudio=self.webpackChunkstudio||[]).push([[358,998],{6998:(t,e,s)=>{s.r(e),s.d(e,{BasePage:()=>a});class a{constructor(t,e,s,a){this.walletConnect=t,this.algodClient=s,this.algoIndexer=a,this.holdings=e}}},2358:(t,e,s)=>{s.r(e),s.d(e,{GrinderQueue:()=>r});var a=s(6998),o=s(5190),n=s(2417);class r extends a.BasePage{constructor(){super(...arguments),this.ui=document.createElement("div"),this.ui.innerHTML='\n    <button class="button-alt" id="refresh-button">Refresh</button>\n    <table class="table" style="table-layout: fixed; color: var(--white);">\n      <thead>\n        <tr>\n          <th scope="col" style="width:6px">&nbsp;</th>\n          <th scope="col">Txn</th>\n          <th scope="col">Group</th>\n          <th scope="col">Date</th>\n          <th scope="col">Sender</th>\n          <th scope="col">Bather</th>\n          <th scope="col">Card</th>\n          <th scope="col">Status</th>\n        </tr>\n      </thead>\n      <tbody id="table-body">\n      </tbody>\n    </table>\n        ',this.load(),this.ui.querySelector("#refresh-button").addEventListener("click",(()=>{this.load()}),!1)}async load(){const t=o.default.filter((t=>"caffeineCards"===t.name))[0].addresses[0];let e=!1;(n.Z.algodUrl.includes("testnet")||n.Z.algoIndexerUrl.includes("testnet"))&&(e=!0);let s,a=[];do{const e=await this.algoIndexer.searchForTransactions(t).address(t).addressRole("receiver").txType("axfer").currencyGreaterThan(0).nextToken(s).do();for(const t of e.transactions)1===t["asset-transfer-transaction"].amount&&t.note&&atob(t.note).includes('"evolve":')&&a.push(t);s=e["next-token"]}while(s);a.sort(((t,e)=>e["round-time"]-t.roundtime));const r=this.ui.querySelector("#table-body");let l,d;r.textContent="";for(const s of a){const a=JSON.parse(atob(s.note)).evolve,o=s["asset-transfer-transaction"]["asset-id"];let n,c;try{n=await this.algoIndexer.lookupAssetByID(a).do()}catch(t){console.error(t)}try{c=await this.algoIndexer.lookupAssetByID(o).do()}catch(t){console.error(t)}let i="";e&&(i="testnet.");let p="";try{const t=await fetch(`https://api.${i}nf.domains/nfd/address?address=${s.sender}`);if(200===t.status){const e=await t.json();p=`<a href="https://${e[0].name}.xyz" target="_blank">${e[0].name}</a>`}}catch(t){console.error(t)}const h=new Date(1e3*s["round-time"]),{statuses:u,groupId:g}=await this.getStatus(s.id,s.group,a,o,t);let b="";g&&(b=`<br><small><a href="https://${i}algoexplorer.io/tx/group/${encodeURIComponent(g)}" class="link-secondary" target="_blank">Txns group</a></small>`),l?void 0!==s.group&&d!==s.group&&(l="darkgoldenrod"===l?"darkcyan":"darkgoldenrod"):l="darkgoldenrod";const f=document.createElement("tr");f.innerHTML=`\n      <td style="background-color:${s.group?l:"none"};">\n      </td>\n      <td style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"><a href="https://${i}algoexplorer.io/tx/${s.id}" target="_blank">${s.id}</a><br><a href="#" id="btn-${s.id}" style="opacity: 0.5;">copy</a>\n      </td>\n      <td style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">\n      <a href="https://${i}algoexplorer.io/tx/group/${encodeURIComponent(s.group)}" target="_blank">${s.group}</a>\n      </td>\n      <td>${h.toLocaleString()}</td>\n      <td style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"><a href="https://${i}algoexplorer.io/address/${s.sender}" target="_blank">${s.sender}</a><br>${p}</td>\n      <td><a href="https://www.nftexplorer.app/asset/${a}" target="_blank">${n?n.asset.params.name:"unknown"}</a><br><small class="text-secondary">${a}</small></td>\n      <td><a href="https://www.nftexplorer.app/asset/${o}" target="_blank">${c?c.asset.params.name:"unknown"}</a><br><small class="text-secondary">${o}</small></td>\n      <td>${u.join(" ")}${b}</td>\n      `,r.appendChild(f),f.querySelector(`#btn-${s.id}`).addEventListener("click",(t=>{navigator.clipboard.writeText(s.id),t.preventDefault()}),!1),d=s.group}}async getStatus(t,e,s,a,o){let n,r=[];const l=await this.algoIndexer.lookupAssetTransactions(s).txType("acfg").do();for(const s of l.transactions)if(s.note){const a=JSON.parse(atob(s.note));a&&"update"===a.type&&(a.requestTxn===t||a.group&&a.group===e)&&(r.push('<span class="badge text-bg-success">updated</span>'),n=s.group)}const d=await this.algoIndexer.lookupAssetTransactions(a).txType("axfer").address(o).addressRole("sender").do();for(const s of d.transactions)if(s.note){let a;try{a=JSON.parse(atob(s.note))}catch(t){console.error(t)}a&&"burn"===a.type&&(a.requestTxn===t||a.group&&a.group===e)&&r.push('<span class="badge text-bg-success">burned</span>')}return 0===r.length&&r.push('<span class="badge text-bg-warning">pending</span>'),{statuses:r,groupId:n}}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3hCcEIsT0FBTyxTQUNQRixRQUFRVCxHQUNSVSxZQUFZLFVBQ1pHLEtBRUgsSUFBSyxNQUFNK0QsS0FBZ0JELEVBQXNCckUsYUFDL0MsR0FBSXNFLEVBQWE1RCxLQUFNLENBRXJCLElBQUl3RCxFQUVKLElBQ0VBLEVBQVc1QyxLQUFLQyxNQUFNWixLQUFLMkQsRUFBYTVELE1BRzFDLENBRkUsTUFBTzZELEdBQ1B6QyxRQUFRQyxNQUFNd0MsRUFDaEIsQ0FHRUwsR0FDa0IsU0FBbEJBLEVBQVNDLE9BQ1JELEVBQVNFLGFBQWVQLEdBQ3RCSyxFQUFTcEIsT0FBU29CLEVBQVNwQixRQUFVZ0IsSUFFeENwQixFQUFTN0IsS0FBSyxvREFFbEIsQ0FPRixPQUp3QixJQUFwQjZCLEVBQVM4QixRQUNYOUIsRUFBUzdCLEtBQUssc0RBR1QsQ0FBRTZCLFdBQVVDLFVBQ3JCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdHVkaW8vLi9zcmMvcGFnZXMvYmFzZS5qcyIsIndlYnBhY2s6Ly9zdHVkaW8vLi9zcmMvcGFnZXMvZ3JpbmRlci1xdWV1ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCBjbGFzcyBCYXNlUGFnZSB7XG5cbiAgICBjb25zdHJ1Y3Rvcih3YWxsZXRDb25uZWN0LCBob2xkaW5ncywgYWxnb2RDbGllbnQsIGFsZ29JbmRleGVyKXtcblxuICAgICAgICB0aGlzLndhbGxldENvbm5lY3QgPSB3YWxsZXRDb25uZWN0O1xuICAgICAgICB0aGlzLmFsZ29kQ2xpZW50ID0gYWxnb2RDbGllbnQ7XG4gICAgICAgIHRoaXMuYWxnb0luZGV4ZXIgPSBhbGdvSW5kZXhlcjtcbiAgICAgICAgdGhpcy5ob2xkaW5ncyA9IGhvbGRpbmdzO1xuXG4gICAgICAgIFxuXG4gICAgfVxuXG59IiwiaW1wb3J0IHsgQmFzZVBhZ2UgfSBmcm9tIFwiLi9iYXNlLmpzXCI7XG5pbXBvcnQgY29sbGVjdGlvbiBmcm9tIFwiLi4vY29sbGVjdGlvbnMuanNcIjtcbmltcG9ydCBzZXR0aW5ncyBmcm9tIFwiY3VzdG9tLXNldHRpbmdzXCI7XG5cbmV4cG9ydCBjbGFzcyBHcmluZGVyUXVldWUgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XG5cbiAgICB0aGlzLnVpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0aGlzLnVpLmlubmVySFRNTCA9IGBcbiAgICA8YnV0dG9uIGNsYXNzPVwiYnV0dG9uLWFsdFwiIGlkPVwicmVmcmVzaC1idXR0b25cIj5SZWZyZXNoPC9idXR0b24+XG4gICAgPHRhYmxlIGNsYXNzPVwidGFibGVcIiBzdHlsZT1cInRhYmxlLWxheW91dDogZml4ZWQ7IGNvbG9yOiB2YXIoLS13aGl0ZSk7XCI+XG4gICAgICA8dGhlYWQ+XG4gICAgICAgIDx0cj5cbiAgICAgICAgICA8dGggc2NvcGU9XCJjb2xcIiBzdHlsZT1cIndpZHRoOjZweFwiPiZuYnNwOzwvdGg+XG4gICAgICAgICAgPHRoIHNjb3BlPVwiY29sXCI+VHhuPC90aD5cbiAgICAgICAgICA8dGggc2NvcGU9XCJjb2xcIj5Hcm91cDwvdGg+XG4gICAgICAgICAgPHRoIHNjb3BlPVwiY29sXCI+RGF0ZTwvdGg+XG4gICAgICAgICAgPHRoIHNjb3BlPVwiY29sXCI+U2VuZGVyPC90aD5cbiAgICAgICAgICA8dGggc2NvcGU9XCJjb2xcIj5CYXRoZXI8L3RoPlxuICAgICAgICAgIDx0aCBzY29wZT1cImNvbFwiPkNhcmQ8L3RoPlxuICAgICAgICAgIDx0aCBzY29wZT1cImNvbFwiPlN0YXR1czwvdGg+XG4gICAgICAgIDwvdHI+XG4gICAgICA8L3RoZWFkPlxuICAgICAgPHRib2R5IGlkPVwidGFibGUtYm9keVwiPlxuICAgICAgPC90Ym9keT5cbiAgICA8L3RhYmxlPlxuICAgICAgICBgO1xuXG4gICAgdGhpcy5sb2FkKCk7XG5cbiAgICB0aGlzLnVpLnF1ZXJ5U2VsZWN0b3IoXCIjcmVmcmVzaC1idXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIFwiY2xpY2tcIixcbiAgICAgICgpID0+IHtcbiAgICAgICAgdGhpcy5sb2FkKCk7XG4gICAgICB9LFxuICAgICAgZmFsc2VcbiAgICApO1xuICB9XG5cbiAgYXN5bmMgbG9hZCgpIHtcbiAgICBjb25zdCBjYXJkQ29sbGVjdGlvbkluZm8gPSBjb2xsZWN0aW9uLmZpbHRlcihcbiAgICAgIChjKSA9PiBjLm5hbWUgPT09IFwiY2FmZmVpbmVDYXJkc1wiXG4gICAgKTtcbiAgICBjb25zdCBjYXJkQ3JlYXRvckFkZHJlc3MgPSBjYXJkQ29sbGVjdGlvbkluZm9bMF0uYWRkcmVzc2VzWzBdO1xuXG4gICAgbGV0IHRlc3RuZXQgPSBmYWxzZTtcblxuICAgIGlmIChcbiAgICAgIHNldHRpbmdzLmFsZ29kVXJsLmluY2x1ZGVzKFwidGVzdG5ldFwiKSB8fFxuICAgICAgc2V0dGluZ3MuYWxnb0luZGV4ZXJVcmwuaW5jbHVkZXMoXCJ0ZXN0bmV0XCIpXG4gICAgKSB7XG4gICAgICB0ZXN0bmV0ID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBsZXQgdHJhbnNhY3Rpb25zID0gW107XG5cbiAgICBsZXQgbmV4dFRva2VuO1xuXG4gICAgZG8ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hbGdvSW5kZXhlclxuICAgICAgICAuc2VhcmNoRm9yVHJhbnNhY3Rpb25zKGNhcmRDcmVhdG9yQWRkcmVzcylcbiAgICAgICAgLmFkZHJlc3MoY2FyZENyZWF0b3JBZGRyZXNzKVxuICAgICAgICAuYWRkcmVzc1JvbGUoXCJyZWNlaXZlclwiKVxuICAgICAgICAudHhUeXBlKFwiYXhmZXJcIilcbiAgICAgICAgLmN1cnJlbmN5R3JlYXRlclRoYW4oMClcbiAgICAgICAgLm5leHRUb2tlbihuZXh0VG9rZW4pXG4gICAgICAgIC5kbygpO1xuXG4gICAgICBmb3IgKGNvbnN0IHR4biBvZiByZXN1bHQudHJhbnNhY3Rpb25zKSB7XG4gICAgICAgIGlmICh0eG5bXCJhc3NldC10cmFuc2Zlci10cmFuc2FjdGlvblwiXS5hbW91bnQgIT09IDEpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdHhuLm5vdGUpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhdG9iKHR4bi5ub3RlKS5pbmNsdWRlcygnXCJldm9sdmVcIjonKSkge1xuICAgICAgICAgIHRyYW5zYWN0aW9ucy5wdXNoKHR4bik7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbmV4dFRva2VuID0gcmVzdWx0W1wibmV4dC10b2tlblwiXTtcbiAgICB9IHdoaWxlIChuZXh0VG9rZW4pO1xuXG4gICAgLy9vcmRlciBieSB0aW1lIGJhY2t3YXJkXG4gICAgdHJhbnNhY3Rpb25zLnNvcnQoKGEsIGIpID0+IGJbXCJyb3VuZC10aW1lXCJdIC0gYVtcInJvdW5kdGltZVwiXSk7XG5cbiAgICBjb25zdCB0YWJsZUJvZHkgPSB0aGlzLnVpLnF1ZXJ5U2VsZWN0b3IoXCIjdGFibGUtYm9keVwiKTtcbiAgICB0YWJsZUJvZHkudGV4dENvbnRlbnQgPSBcIlwiO1xuXG4gICAgbGV0IGdyb3VwQ29sb3I7XG4gICAgbGV0IHByZXZHcm91cDtcblxuICAgIGZvciAoY29uc3QgdHhuIG9mIHRyYW5zYWN0aW9ucykge1xuICAgICAgY29uc3Qgbm90ZSA9IEpTT04ucGFyc2UoYXRvYih0eG4ubm90ZSkpO1xuICAgICAgY29uc3QgYmF0aGVyQXNzZXRJZCA9IG5vdGUuZXZvbHZlO1xuICAgICAgY29uc3QgY2FyZEFzc2V0SWQgPSB0eG5bXCJhc3NldC10cmFuc2Zlci10cmFuc2FjdGlvblwiXVtcImFzc2V0LWlkXCJdO1xuXG4gICAgICAvL2xvYWQgYXNzZXRzIGRldGFpbHNcbiAgICAgIGxldCBiYXRoZXJBc3NldFJlc3VsdDtcbiAgICAgIGxldCBjYXJkQXNzZXRSZXN1bHQ7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGJhdGhlckFzc2V0UmVzdWx0ID0gYXdhaXQgdGhpcy5hbGdvSW5kZXhlclxuICAgICAgICAgIC5sb29rdXBBc3NldEJ5SUQoYmF0aGVyQXNzZXRJZClcbiAgICAgICAgICAuZG8oKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNhcmRBc3NldFJlc3VsdCA9IGF3YWl0IHRoaXMuYWxnb0luZGV4ZXJcbiAgICAgICAgICAubG9va3VwQXNzZXRCeUlEKGNhcmRBc3NldElkKVxuICAgICAgICAgIC5kbygpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH1cblxuICAgICAgbGV0IHRlc25ldFN1YmRvbWFpbiA9IFwiXCI7XG4gICAgICBpZiAodGVzdG5ldCkge1xuICAgICAgICB0ZXNuZXRTdWJkb21haW4gPSBcInRlc3RuZXQuXCI7XG4gICAgICB9XG5cbiAgICAgIC8vdHJ5IHRvIGxvYWQgbmZkIGFkZHJlc3NcbiAgICAgIC8vbG9vayBmb3IgYW4gbmZkIGRvbWFpbiBhZGRyZXNzXG5cbiAgICAgIGxldCBuZmQgPSBcIlwiO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgICBgaHR0cHM6Ly9hcGkuJHt0ZXNuZXRTdWJkb21haW59bmYuZG9tYWlucy9uZmQvYWRkcmVzcz9hZGRyZXNzPSR7dHhuLnNlbmRlcn1gXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgY29uc3QgbmZkUmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICAgICAgbmZkID0gYDxhIGhyZWY9XCJodHRwczovLyR7bmZkUmVzdWx0WzBdLm5hbWV9Lnh5elwiIHRhcmdldD1cIl9ibGFua1wiPiR7bmZkUmVzdWx0WzBdLm5hbWV9PC9hPmA7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJvdW5kRGF0ZSA9IG5ldyBEYXRlKHR4bltcInJvdW5kLXRpbWVcIl0gKiAxMDAwKTtcblxuICAgICAgY29uc3QgeyBzdGF0dXNlcywgZ3JvdXBJZCB9ID0gYXdhaXQgdGhpcy5nZXRTdGF0dXMoXG4gICAgICAgIHR4bi5pZCxcbiAgICAgICAgdHhuLmdyb3VwLFxuICAgICAgICBiYXRoZXJBc3NldElkLFxuICAgICAgICBjYXJkQXNzZXRJZCxcbiAgICAgICAgY2FyZENyZWF0b3JBZGRyZXNzXG4gICAgICApO1xuXG4gICAgICBsZXQgZ3JvdXBUeG5MaW5rID0gXCJcIjtcbiAgICAgIGlmIChncm91cElkKSB7XG4gICAgICAgIGdyb3VwVHhuTGluayA9IGA8YnI+PHNtYWxsPjxhIGhyZWY9XCJodHRwczovLyR7dGVzbmV0U3ViZG9tYWlufWFsZ29leHBsb3Jlci5pby90eC9ncm91cC8ke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICBncm91cElkXG4gICAgICAgICl9XCIgY2xhc3M9XCJsaW5rLXNlY29uZGFyeVwiIHRhcmdldD1cIl9ibGFua1wiPlR4bnMgZ3JvdXA8L2E+PC9zbWFsbD5gO1xuICAgICAgfVxuXG4gICAgICAvL2dyb3VwIGNvbG9yXG4gICAgICBpZiAoIWdyb3VwQ29sb3Ipe1xuICAgICAgICBncm91cENvbG9yID0gJ2Rhcmtnb2xkZW5yb2QnO1xuICAgICAgfSBlbHNlIGlmICh0eG4uZ3JvdXAgIT09IHVuZGVmaW5lZCAmJiBwcmV2R3JvdXAgIT09IHR4bi5ncm91cCl7XG4gICAgICAgIGdyb3VwQ29sb3IgPSBncm91cENvbG9yID09PSAnZGFya2dvbGRlbnJvZCcgPyAnZGFya2N5YW4nIDogJ2Rhcmtnb2xkZW5yb2QnO1xuICAgICAgfSBcblxuICAgICAgY29uc3QgbmV3VGFibGVSb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidHJcIik7XG4gICAgICBuZXdUYWJsZVJvdy5pbm5lckhUTUwgPSBgXG4gICAgICA8dGQgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiR7dHhuLmdyb3VwID8gZ3JvdXBDb2xvciA6ICdub25lJ307XCI+XG4gICAgICA8L3RkPlxuICAgICAgPHRkIHN0eWxlPVwib3ZlcmZsb3c6IGhpZGRlbjsgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7IHdoaXRlLXNwYWNlOiBub3dyYXA7XCI+PGEgaHJlZj1cImh0dHBzOi8vJHt0ZXNuZXRTdWJkb21haW59YWxnb2V4cGxvcmVyLmlvL3R4LyR7XG4gICAgICAgIHR4bi5pZFxuICAgICAgfVwiIHRhcmdldD1cIl9ibGFua1wiPiR7dHhuLmlkfTwvYT48YnI+PGEgaHJlZj1cIiNcIiBpZD1cImJ0bi0ke1xuICAgICAgICB0eG4uaWRcbiAgICAgIH1cIiBzdHlsZT1cIm9wYWNpdHk6IDAuNTtcIj5jb3B5PC9hPlxuICAgICAgPC90ZD5cbiAgICAgIDx0ZCBzdHlsZT1cIm92ZXJmbG93OiBoaWRkZW47IHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOyB3aGl0ZS1zcGFjZTogbm93cmFwO1wiPlxuICAgICAgPGEgaHJlZj1cImh0dHBzOi8vJHt0ZXNuZXRTdWJkb21haW59YWxnb2V4cGxvcmVyLmlvL3R4L2dyb3VwLyR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICB0eG4uZ3JvdXBcbiAgICAgICl9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHt0eG4uZ3JvdXB9PC9hPlxuICAgICAgPC90ZD5cbiAgICAgIDx0ZD4ke3JvdW5kRGF0ZS50b0xvY2FsZVN0cmluZygpfTwvdGQ+XG4gICAgICA8dGQgc3R5bGU9XCJvdmVyZmxvdzogaGlkZGVuOyB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsgd2hpdGUtc3BhY2U6IG5vd3JhcDtcIj48YSBocmVmPVwiaHR0cHM6Ly8ke3Rlc25ldFN1YmRvbWFpbn1hbGdvZXhwbG9yZXIuaW8vYWRkcmVzcy8ke1xuICAgICAgICB0eG4uc2VuZGVyXG4gICAgICB9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHt0eG4uc2VuZGVyfTwvYT48YnI+JHtuZmR9PC90ZD5cbiAgICAgIDx0ZD48YSBocmVmPVwiaHR0cHM6Ly93d3cubmZ0ZXhwbG9yZXIuYXBwL2Fzc2V0LyR7YmF0aGVyQXNzZXRJZH1cIiB0YXJnZXQ9XCJfYmxhbmtcIj4ke1xuICAgICAgICBiYXRoZXJBc3NldFJlc3VsdCA/IGJhdGhlckFzc2V0UmVzdWx0LmFzc2V0LnBhcmFtcy5uYW1lIDogXCJ1bmtub3duXCJcbiAgICAgIH08L2E+PGJyPjxzbWFsbCBjbGFzcz1cInRleHQtc2Vjb25kYXJ5XCI+JHtiYXRoZXJBc3NldElkfTwvc21hbGw+PC90ZD5cbiAgICAgIDx0ZD48YSBocmVmPVwiaHR0cHM6Ly93d3cubmZ0ZXhwbG9yZXIuYXBwL2Fzc2V0LyR7Y2FyZEFzc2V0SWR9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHtcbiAgICAgICAgY2FyZEFzc2V0UmVzdWx0ID8gY2FyZEFzc2V0UmVzdWx0LmFzc2V0LnBhcmFtcy5uYW1lIDogXCJ1bmtub3duXCJcbiAgICAgIH08L2E+PGJyPjxzbWFsbCBjbGFzcz1cInRleHQtc2Vjb25kYXJ5XCI+JHtjYXJkQXNzZXRJZH08L3NtYWxsPjwvdGQ+XG4gICAgICA8dGQ+JHtzdGF0dXNlcy5qb2luKFwiIFwiKX0ke2dyb3VwVHhuTGlua308L3RkPlxuICAgICAgYDtcblxuICAgICAgdGFibGVCb2R5LmFwcGVuZENoaWxkKG5ld1RhYmxlUm93KTtcblxuICAgICAgbmV3VGFibGVSb3cucXVlcnlTZWxlY3RvcihgI2J0bi0ke3R4bi5pZH1gKS5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICBcImNsaWNrXCIsXG4gICAgICAgIChldmVudCkgPT4ge1xuICAgICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHR4bi5pZCk7XG5cbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9LFxuICAgICAgICBmYWxzZVxuICAgICAgKTtcblxuICAgICAgcHJldkdyb3VwID0gdHhuLmdyb3VwO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFN0YXR1cyh0eG5JZCwgcmVxdWVzdEdyb3VwSWQsIGJhdGhlckFzc2V0SWQsIGNhcmRBc3NldElkLCBjYXJkQ3JlYXRvckFkZHJlc3MpIHtcbiAgICBsZXQgc3RhdHVzZXMgPSBbXTtcbiAgICBsZXQgZ3JvdXBJZDtcblxuICAgIC8vY2hlY2sgaWYgYmF0aGVyIGFzc2V0IGhhdmUgYmVlbiB1cGRhdGVkXG4gICAgY29uc3QgYmF0aGVyQXNzZXRUcmFuc2FjdGlvbnMgPSBhd2FpdCB0aGlzLmFsZ29JbmRleGVyXG4gICAgICAubG9va3VwQXNzZXRUcmFuc2FjdGlvbnMoYmF0aGVyQXNzZXRJZClcbiAgICAgIC50eFR5cGUoXCJhY2ZnXCIpXG4gICAgICAuZG8oKTtcblxuICAgIGZvciAoY29uc3QgY29uZmlnVHhuIG9mIGJhdGhlckFzc2V0VHJhbnNhY3Rpb25zLnRyYW5zYWN0aW9ucykge1xuICAgICAgaWYgKGNvbmZpZ1R4bi5ub3RlKSB7XG4gICAgICAgIGNvbnN0IG5vdGVKc29uID0gSlNPTi5wYXJzZShhdG9iKGNvbmZpZ1R4bi5ub3RlKSk7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgIG5vdGVKc29uICYmXG4gICAgICAgICAgbm90ZUpzb24udHlwZSA9PT0gXCJ1cGRhdGVcIiAmJlxuICAgICAgICAgIChub3RlSnNvbi5yZXF1ZXN0VHhuID09PSB0eG5JZCB8fFxuICAgICAgICAgICAgKG5vdGVKc29uLmdyb3VwICYmIG5vdGVKc29uLmdyb3VwID09PSByZXF1ZXN0R3JvdXBJZCkpXG4gICAgICAgICkge1xuICAgICAgICAgIHN0YXR1c2VzLnB1c2goJzxzcGFuIGNsYXNzPVwiYmFkZ2UgdGV4dC1iZy1zdWNjZXNzXCI+dXBkYXRlZDwvc3Bhbj4nKTtcbiAgICAgICAgICBncm91cElkID0gY29uZmlnVHhuLmdyb3VwO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy9jaGVjayBpZiBjYXJkIGFzc2V0IGhhdmUgYmVlbiBidXJuZWRcbiAgICBjb25zdCBjYXJkQXNzZXRUcmFuc2FjdGlvbnMgPSBhd2FpdCB0aGlzLmFsZ29JbmRleGVyXG4gICAgICAubG9va3VwQXNzZXRUcmFuc2FjdGlvbnMoY2FyZEFzc2V0SWQpXG4gICAgICAudHhUeXBlKFwiYXhmZXJcIilcbiAgICAgIC5hZGRyZXNzKGNhcmRDcmVhdG9yQWRkcmVzcylcbiAgICAgIC5hZGRyZXNzUm9sZShcInNlbmRlclwiKVxuICAgICAgLmRvKCk7XG5cbiAgICBmb3IgKGNvbnN0IHRyYW5zZmVydFR4biBvZiBjYXJkQXNzZXRUcmFuc2FjdGlvbnMudHJhbnNhY3Rpb25zKSB7XG4gICAgICBpZiAodHJhbnNmZXJ0VHhuLm5vdGUpIHtcblxuICAgICAgICBsZXQgbm90ZUpzb247XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBub3RlSnNvbiA9IEpTT04ucGFyc2UoYXRvYih0cmFuc2ZlcnRUeG4ubm90ZSkpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGUpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoXG4gICAgICAgICAgbm90ZUpzb24gJiZcbiAgICAgICAgICBub3RlSnNvbi50eXBlID09PSBcImJ1cm5cIiAmJlxuICAgICAgICAgIChub3RlSnNvbi5yZXF1ZXN0VHhuID09PSB0eG5JZCB8fFxuICAgICAgICAgICAgKG5vdGVKc29uLmdyb3VwICYmIG5vdGVKc29uLmdyb3VwID09PSByZXF1ZXN0R3JvdXBJZCkpXG4gICAgICAgICkge1xuICAgICAgICAgIHN0YXR1c2VzLnB1c2goJzxzcGFuIGNsYXNzPVwiYmFkZ2UgdGV4dC1iZy1zdWNjZXNzXCI+YnVybmVkPC9zcGFuPicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHN0YXR1c2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc3RhdHVzZXMucHVzaCgnPHNwYW4gY2xhc3M9XCJiYWRnZSB0ZXh0LWJnLXdhcm5pbmdcIj5wZW5kaW5nPC9zcGFuPicpO1xuICAgIH1cblxuICAgIHJldHVybiB7IHN0YXR1c2VzLCBncm91cElkIH07XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJCYXNlUGFnZSIsImNvbnN0cnVjdG9yIiwid2FsbGV0Q29ubmVjdCIsImhvbGRpbmdzIiwiYWxnb2RDbGllbnQiLCJhbGdvSW5kZXhlciIsInRoaXMiLCJHcmluZGVyUXVldWUiLCJzdXBlciIsImFyZ3VtZW50cyIsInVpIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwibG9hZCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiYXN5bmMiLCJjYXJkQ3JlYXRvckFkZHJlc3MiLCJjIiwibmFtZSIsImFkZHJlc3NlcyIsInRlc3RuZXQiLCJuZXh0VG9rZW4iLCJ0cmFuc2FjdGlvbnMiLCJyZXN1bHQiLCJzZWFyY2hGb3JUcmFuc2FjdGlvbnMiLCJhZGRyZXNzIiwiYWRkcmVzc1JvbGUiLCJ0eFR5cGUiLCJjdXJyZW5jeUdyZWF0ZXJUaGFuIiwiZG8iLCJ0eG4iLCJhbW91bnQiLCJub3RlIiwiYXRvYiIsImluY2x1ZGVzIiwicHVzaCIsInNvcnQiLCJhIiwiYiIsInRhYmxlQm9keSIsImdyb3VwQ29sb3IiLCJwcmV2R3JvdXAiLCJ0ZXh0Q29udGVudCIsImJhdGhlckFzc2V0SWQiLCJKU09OIiwicGFyc2UiLCJldm9sdmUiLCJjYXJkQXNzZXRJZCIsImJhdGhlckFzc2V0UmVzdWx0IiwiY2FyZEFzc2V0UmVzdWx0IiwibG9va3VwQXNzZXRCeUlEIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwidGVzbmV0U3ViZG9tYWluIiwibmZkIiwicmVzcG9uc2UiLCJmZXRjaCIsInNlbmRlciIsInN0YXR1cyIsIm5mZFJlc3VsdCIsImpzb24iLCJyb3VuZERhdGUiLCJEYXRlIiwic3RhdHVzZXMiLCJncm91cElkIiwiZ2V0U3RhdHVzIiwiaWQiLCJncm91cCIsImdyb3VwVHhuTGluayIsImVuY29kZVVSSUNvbXBvbmVudCIsInVuZGVmaW5lZCIsIm5ld1RhYmxlUm93IiwidG9Mb2NhbGVTdHJpbmciLCJhc3NldCIsInBhcmFtcyIsImpvaW4iLCJhcHBlbmRDaGlsZCIsImV2ZW50IiwibmF2aWdhdG9yIiwiY2xpcGJvYXJkIiwid3JpdGVUZXh0IiwicHJldmVudERlZmF1bHQiLCJ0eG5JZCIsInJlcXVlc3RHcm91cElkIiwiYmF0aGVyQXNzZXRUcmFuc2FjdGlvbnMiLCJsb29rdXBBc3NldFRyYW5zYWN0aW9ucyIsImNvbmZpZ1R4biIsIm5vdGVKc29uIiwidHlwZSIsInJlcXVlc3RUeG4iLCJjYXJkQXNzZXRUcmFuc2FjdGlvbnMiLCJ0cmFuc2ZlcnRUeG4iLCJlIiwibGVuZ3RoIl0sInNvdXJjZVJvb3QiOiIifQ==